<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edge Popup Test - Find the Right Configuration</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 40px 20px;
            background: linear-gradient(135deg, #1db954 0%, #1ed760 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            color: #191414;
            margin-bottom: 16px;
            font-size: 2.5em;
            font-weight: 700;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin: 32px 0;
        }
        
        .test-card {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }
        
        .test-card h3 {
            margin: 0 0 16px 0;
            color: #0078d4;
            font-size: 1.2em;
        }
        
        .test-description {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 16px;
        }
        
        .badge-container {
            margin: 16px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .instructions {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 24px;
            text-align: left;
        }
        
        .instructions h3 {
            margin: 0 0 12px 0;
            color: #1976d2;
        }
        
        .browser-info {
            background: #fff3e0;
            padding: 16px;
            border-radius: 8px;
            margin-top: 24px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¨ Edge Popup Test</h1>
        <p>Test different Microsoft Store badge configurations to find which one creates the native popup in Edge</p>
        
        <div class="instructions">
            <h3>üìã Testing Instructions for Edge Users:</h3>
            <ol>
                <li>Open this page in Microsoft Edge</li>
                <li>Try clicking each badge below</li>
                <li>Note which one shows a <strong>popup over this page</strong> vs which ones navigate away</li>
                <li>The goal is to find the configuration that keeps you on this page with a popup</li>
            </ol>
        </div>
        
        <div class="test-grid">
            <!-- Test 1: No window-mode (default) -->
            <div class="test-card">
                <h3>Test 1: Default (No window-mode)</h3>
                <div class="test-description">
                    Uses Microsoft's default behavior without specifying window-mode
                </div>
                <div class="badge-container">
                    <script type="module" src="https://get.microsoft.com/badge/ms-store-badge.bundled.js"></script>
                    <ms-store-badge 
                        productid="9NCBCSZSJRSB" 
                        productname="Spotify Music" 
                        theme="auto"
                        cid="test-default">
                    </ms-store-badge>
                </div>
            </div>
            
            <!-- Test 2: window-mode="direct" -->
            <div class="test-card">
                <h3>Test 2: Direct Mode</h3>
                <div class="test-description">
                    window-mode="direct" - supposed to download installer and stay on page
                </div>
                <div class="badge-container">
                    <ms-store-badge 
                        productid="9NCBCSZSJRSB" 
                        productname="Spotify Music" 
                        window-mode="direct"
                        theme="auto"
                        cid="test-direct">
                    </ms-store-badge>
                </div>
            </div>
            
            <!-- Test 3: window-mode="full" -->
            <div class="test-card">
                <h3>Test 3: Full Mode</h3>
                <div class="test-description">
                    window-mode="full" - supposed to open full Store app
                </div>
                <div class="badge-container">
                    <ms-store-badge 
                        productid="9NCBCSZSJRSB" 
                        productname="Spotify Music" 
                        window-mode="full"
                        theme="auto"
                        cid="test-full">
                    </ms-store-badge>
                </div>
            </div>
            
            <!-- Test 4: Different product (to see if it matters) -->
            <div class="test-card">
                <h3>Test 4: Different App (Discord)</h3>
                <div class="test-description">
                    Default mode with Discord app to test if product matters
                </div>
                <div class="badge-container">
                    <ms-store-badge 
                        productid="XPDC2RH70K22MN" 
                        productname="Discord" 
                        theme="auto"
                        cid="test-discord">
                    </ms-store-badge>
                </div>
            </div>
            
            <!-- Test 5: Manual link to ms-windows-store protocol -->
            <div class="test-card">
                <h3>Test 5: Direct Protocol Link</h3>
                <div class="test-description">
                    Direct ms-windows-store:// protocol link (not using badge component)
                </div>
                <div class="badge-container">
                    <a href="ms-windows-store://pdp/?ProductId=9NCBCSZSJRSB" 
                       style="display: inline-block; padding: 8px 16px; background: #0078d4; color: white; text-decoration: none; border-radius: 4px;">
                        üì± Direct Store Protocol
                    </a>
                </div>
            </div>
            
            <!-- Test 6: Regular web link to Store -->
            <div class="test-card">
                <h3>Test 6: Regular Web Link</h3>
                <div class="test-description">
                    Regular https link to Microsoft Store web page
                </div>
                <div class="badge-container">
                    <a href="https://apps.microsoft.com/detail/9NCBCSZSJRSB" 
                       target="_blank"
                       style="display: inline-block; padding: 8px 16px; background: #1db954; color: white; text-decoration: none; border-radius: 4px;">
                        üåê Web Store Link
                    </a>
                </div>
            </div>
        </div>
        
        <div class="browser-info">
            <div id="browser-detection"></div>
        </div>
    </div>

    <script>
        // Browser detection
        function detectBrowser() {
            const userAgent = navigator.userAgent.toLowerCase();
            
            if (userAgent.includes('edg/') || userAgent.includes('edge/')) {
                return 'üî∑ Microsoft Edge - Perfect for testing!';
            }
            if (userAgent.includes('firefox/')) {
                return 'ü¶ä Firefox - For best popup testing, try this page in Edge';
            }
            if (userAgent.includes('chrome/')) {
                return 'üåê Chrome - For best popup testing, try this page in Edge';
            }
            
            return '‚ùì Unknown browser - For best popup testing, try this page in Edge';
        }
        
        // Display browser info
        document.getElementById('browser-detection').innerHTML = `
            <strong>Browser detected:</strong> ${detectBrowser()}
        `;
        
        // Add click tracking to see what happens
        document.addEventListener('click', function(e) {
            if (e.target.closest('ms-store-badge') || e.target.closest('a[href*="ms-windows-store"]')) {
                console.log('Microsoft Store element clicked:', e.target);
                
                // Check after a delay to see if we're still on this page
                setTimeout(() => {
                    if (document.hasFocus()) {
                        console.log('Still on page - might have popup or download');
                    } else {
                        console.log('Left page - probably opened Store app');
                    }
                }, 1000);
            }
        });
    </script>
</body>
</html>
